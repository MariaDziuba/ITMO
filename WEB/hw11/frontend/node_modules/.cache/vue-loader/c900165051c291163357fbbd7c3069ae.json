{"remainingRequest":"/Users/maria/Desktop/hw11/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/maria/Desktop/hw11/frontend/src/App.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/maria/Desktop/hw11/frontend/src/App.vue","mtime":1608291754144},{"path":"/Users/maria/Desktop/hw11/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/maria/Desktop/hw11/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/maria/Desktop/hw11/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/maria/Desktop/hw11/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBIZWFkZXIgZnJvbSAnLi9jb21wb25lbnRzL0hlYWRlcicKaW1wb3J0IE1pZGRsZSBmcm9tICcuL2NvbXBvbmVudHMvTWlkZGxlJwppbXBvcnQgRm9vdGVyIGZyb20gJy4vY29tcG9uZW50cy9Gb290ZXInCmltcG9ydCBheGlvcyBmcm9tICdheGlvcycKCmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6ICdhcHAnLAogICAgZGF0YTogZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHVzZXI6IG51bGwsCiAgICAgICAgICAgIHBvc3RzOiBbXQogICAgICAgIH0KICAgIH0sCiAgICBjb21wb25lbnRzOiB7CiAgICAgICAgSGVhZGVyLAogICAgICAgIE1pZGRsZSwKICAgICAgICBGb290ZXIKICAgIH0sIGJlZm9yZUNyZWF0ZSgpIHsKICAgICAgICBheGlvcy5nZXQoIi9hcGkvMS9wb3N0cyIpLnRoZW4ocG9zdHMgPT4gdGhpcy5wb3N0cyA9IHBvc3RzWyJkYXRhIl0pOwoKICAgICAgICB0aGlzLiRyb290LiRvbigib25Mb2dvdXQiLCAoKSA9PiB7CiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCJqd3QiKTsKICAgICAgICAgICAgdGhpcy51c2VyID0gbnVsbDsKICAgICAgICB9KTsKCiAgICAgICAgdGhpcy4kcm9vdC4kb24oIm9uUmVnaXN0ZXIiLCAobG9naW4sIHBhc3N3b3JkLCBuYW1lKSA9PiB7CiAgICAgICAgICAgIGF4aW9zLnBvc3QoJ2FwaS8xL3VzZXJzJywgewogICAgICAgICAgICAgICAgbG9naW46IGxvZ2luLAogICAgICAgICAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkLAogICAgICAgICAgICAgICAgbmFtZTogbmFtZQogICAgICAgICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhICYmIHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgib25FbnRlciIsIGxvZ2luLCBwYXNzd29yZCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgib25SZWdpc3RlclZhbGlkYXRpb25FcnJvciIsIGVycm9yLnJlc3BvbnNlLmRhdGEpCiAgICAgICAgICAgIH0pCiAgICAgICAgfSk7CgogICAgICAgIHRoaXMuJHJvb3QuJG9uKCJvbkp3dCIsIChqd3QsIGVudGVyKSA9PiB7CiAgICAgICAgICAgIGF4aW9zLmRlZmF1bHRzLmhlYWRlcnMgPSB7CiAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIgKyBqd3QKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGF4aW9zLmdldCgiL2FwaS8xL3VzZXJzL2F1dGhvcml6ZWQiKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgICAgIHRoaXMudXNlciA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICAgICAgICBpZiAoZW50ZXIpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJvbkVudGVyU3VjY2VzcyIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9KTsKCiAgICAgICAgdGhpcy4kcm9vdC4kb24oIm9uQWRkUG9zdCIsICh0aXRsZSwgdGV4dCkgPT4gewogICAgICAgICAgIGF4aW9zLnBvc3QoIi9hcGkvMS9wb3N0cyIsIHsKICAgICAgICAgICAgICAgdGl0bGU6IHRpdGxlLAogICAgICAgICAgICAgICB0ZXh0OiB0ZXh0CiAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgLnRoZW4oCiAgICAgICAgICAgICAgICAgICBheGlvcy5nZXQoIi9hcGkvMS9wb3N0cyIpCiAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhbGVydCgxMjMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBvc3RzID0gcmVzcG9uc2VbImRhdGEiXQogICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgLnRoZW4odGhpcy4kcm9vdC4kZW1pdCgib25DaGFuZ2VQYWdlIiwgIkluZGV4IikpCiAgICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgib25BZGRQb3N0VmFsaWRhdGlvbkVycm9yIiwgZXJyb3IucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICAgICAgIH0pCiAgICAgICAgfSk7CgogICAgICAgIHRoaXMuJHJvb3QuJG9uKCJvbkVudGVyIiwgKGxvZ2luLCBwYXNzd29yZCkgPT4gewogICAgICAgICAgICBheGlvcy5wb3N0KCIvYXBpLzEvand0IiwgewogICAgICAgICAgICAgICAgbG9naW46IGxvZ2luLAogICAgICAgICAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkCiAgICAgICAgICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImp3dCIsIHJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgib25Kd3QiLCByZXNwb25zZS5kYXRhLCB0cnVlKTsKICAgICAgICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgib25FbnRlclZhbGlkYXRpb25FcnJvciIsIGVycm9yLnJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgIH0sIGJlZm9yZU1vdW50KCkgewogICAgICAgIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiand0IikgJiYgIXRoaXMudXNlcikgewogICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJvbkp3dCIsIGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJqd3QiKSwgdHJ1ZSk7CiAgICAgICAgfQogICAgfQp9Cg=="},{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;;AAUA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<template>\n    <!--suppress HtmlUnknownTag -->\n    <body id=\"app\">\n    <Header :user=\"user\"/>\n    <Middle :user=\"user\" :posts=\"posts\"/>\n    <Footer/>\n    </body>\n</template>\n\n<script>\n    import Header from './components/Header'\n    import Middle from './components/Middle'\n    import Footer from './components/Footer'\n    import axios from 'axios'\n\n    export default {\n        name: 'app',\n        data: function () {\n            return {\n                user: null,\n                posts: []\n            }\n        },\n        components: {\n            Header,\n            Middle,\n            Footer\n        }, beforeCreate() {\n            axios.get(\"/api/1/posts\").then(posts => this.posts = posts[\"data\"]);\n\n            this.$root.$on(\"onLogout\", () => {\n                localStorage.removeItem(\"jwt\");\n                this.user = null;\n            });\n\n            this.$root.$on(\"onRegister\", (login, password, name) => {\n                axios.post('api/1/users', {\n                    login: login,\n                    password: password,\n                    name: name\n                }).then(response => {\n                    if (response.data && response.status === 200) {\n                        this.$root.$emit(\"onEnter\", login, password)\n                    }\n                }).catch(error => {\n                    this.$root.$emit(\"onRegisterValidationError\", error.response.data)\n                })\n            });\n\n            this.$root.$on(\"onJwt\", (jwt, enter) => {\n                axios.defaults.headers = {\n                    Authorization: \"Bearer \" + jwt\n                };\n\n                axios.get(\"/api/1/users/authorized\").then(response => {\n                    this.user = response.data;\n                    if (enter) {\n                        this.$root.$emit(\"onEnterSuccess\");\n                    }\n                });\n            });\n\n            this.$root.$on(\"onAddPost\", (title, text) => {\n               axios.post(\"/api/1/posts\", {\n                   title: title,\n                   text: text\n               })\n                   .then(\n                       axios.get(\"/api/1/posts\")\n                           .then(response => {\n                               // alert(123);\n                               this.posts = response[\"data\"]\n                           })\n                   )\n                   .then(this.$root.$emit(\"onChangePage\", \"Index\"))\n                   .catch(error => {\n                        this.$root.$emit(\"onAddPostValidationError\", error.response.data);\n                   })\n            });\n\n            this.$root.$on(\"onEnter\", (login, password) => {\n                axios.post(\"/api/1/jwt\", {\n                    login: login,\n                    password: password\n                }).then(response => {\n                    localStorage.setItem(\"jwt\", response.data);\n                    this.$root.$emit(\"onJwt\", response.data, true);\n                }).catch(error => {\n                    this.$root.$emit(\"onEnterValidationError\", error.response.data);\n                });\n            });\n        }, beforeMount() {\n            if (localStorage.getItem(\"jwt\") && !this.user) {\n                this.$root.$emit(\"onJwt\", localStorage.getItem(\"jwt\"), true);\n            }\n        }\n    }\n</script>\n\n<style>\n</style>\n"]}]}